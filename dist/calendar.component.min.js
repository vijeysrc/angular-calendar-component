!function(e,t){var a=t();"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():angular&&angular.module?angular.module("vj.calendar.service",[]).factory("CalendarService",[function(){function e(e){return new a(e)}return{getInstance:e}}]):e.CalendarService=a}(this,function(){function e(e){this._state={selected:e instanceof Date?e:new Date,current:e instanceof Date?this.util.dateClone(e):new Date}}return e.prototype.util={names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],getLastDay:function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},getFirstDayth:function(e){var t=new Date(e);return t.setDate(1),t.getDay()},areTheyInSameMonthYear:function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},dateClone:function(e){return new Date(e.getTime())}},e.prototype.getNames=function(){return this.util.names},e.prototype.getSeries=function(){for(var e,t=[],a=this.getCurrentDate(),n=this.getSelectedDate(),r=this.util.getLastDay(a),o=this.util.getFirstDayth(a),l=o,c=this.util.areTheyInSameMonthYear(new Date,a),i=this.util.areTheyInSameMonthYear(n,a),s=(new Date).getDate(),u=n.getDate();l>0;)t.unshift({day:-1,dayth:--l});for(var d=1;r>=d;d++)t.push({day:d,dayth:o++%7,today:!(!c||s!==d),selected:!(!i||u!==d)});for(e=o%7;e>0&&6>=e;)t.push({day:-1,dayth:e++});return t},e.prototype.getMatrix=function(){for(var e,t=[],a=this.getSeries(),n=a.length/7,r=0;n>r;r++){e=[];for(var o=0;7>o;o++)e.push(a[7*r+o]);t.push(e)}return t},e.prototype.goTo=function(e,t){var a,n=this.getCurrentDate();n.setDate(1),"month"===e?a=1:"year"===e&&(a=12),"next"===t?n.setMonth(n.getMonth()+a):"prev"===t&&n.setMonth(n.getMonth()-a)},e.prototype.getCurrentDate=function(){return this._state.current},e.prototype.getSelectedDate=function(){return this._state.selected},e.prototype.setSelectedDate=function(e){var t=this.util.dateClone(this.getCurrentDate());t.setDate(+e),this._state.selected=t},e}),angular.module("vj.calendar",["vj.calendar.service"]).component("vjCalendar",{bindings:{ngModel:"="},templateUrl:"../src/calendar.template.html",controller:["CalendarService",function(e){var t=this;t.service=e.getInstance(t.ngModel),t.updateMatrix=function(){t.matrix=t.service.getMatrix()},t.goTo=function(e,a){t.service.goTo(e,a),t.updateMatrix()},t.selectDate=function(e){-1!==e&&(t.service.setSelectedDate(e),t.updateMatrix(),t.ngModel=t.service.getSelectedDate())},t.updateMatrix()}]}),angular.module("vj.calendar").run(["$templateCache",function(e){e.put("calendar.template.html",'<div class=vj-calendar><table class=vj-calendar__table><thead><tr><td ng-click="$ctrl.goTo(\'year\', \'prev\')"><span>&laquo;</span></td><td ng-click="$ctrl.goTo(\'month\', \'prev\')"><span>&lsaquo;</span></td><td colspan=3>{{$ctrl.service.getCurrentDate() | date:"MMMM yyyy"}}</td><td ng-click="$ctrl.goTo(\'month\', \'next\')"><span>&rsaquo;</span></td><td ng-click="$ctrl.goTo(\'year\', \'next\')"><span>&raquo;</span></td></tr><tr><td ng-repeat="name in $ctrl.service.getNames() track by $index">{{name}}</td></tr></thead><tbody><tr ng-repeat="row in $ctrl.matrix track by $index"><td ng-click=$ctrl.selectDate(cell.day) ng-repeat="cell in row" ng-class="{today: cell.today, selected: cell.selected}"><span>{{cell.day === -1 ? "&nbsp;" : cell.day}}</span></td></tr></tbody></table></div>')}]);